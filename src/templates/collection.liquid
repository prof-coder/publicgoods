<!-- /templates/collection.liquid -->
<script defer>
  {% if customer.tags contains 'B2B' and collection.title == 'All Products' %}
    if (document.referrer.indexOf("https://www.publicgoods.com/account/login") > -1 || document.referrer.indexOf("https://www.publicgoods.com/account/activate/") > -1) {
	  window.location.href= '/collections/b2b'
    }
  {% endif %}

  {% if customer.tags contains 'free-hair-body-bundle' or customer.tags contains 'free-dental-care-membership' or customer.tags contains 'free-italian-bundle' %}
    if (document.referrer.indexOf("https://www.publicgoods.com/account/activate/") > -1) {
      window.location.href= 'https://www.publicgoods.com/pages/free-gift-with-membership'
    }
  {% endif %}
  
  {% if customer %}
  if (document.referrer.indexOf("tell-us-more") > -1) {
      window.location.href= 'https://www.publicgoods.com/pages/share?tkbl_campaign_id=1159669'
    }
  {% endif %}

</script>



<style>   
  {% if customer %}
    @media (max-width: 737px) {
      body {
        margin-top: 20px !important;
      }
    }
  {% endif %}
  
    #ten-off-flow {
    width: 100%;
    z-index: 99;
    height: 120px;
    position: fixed;
    margin-top: 67px;
    background-color: #fff;
    display: none;
  }
  
  #ten-off-flow p {
    text-align: center;
    width: 550px;
    margin: 0 auto;
    padding-top: 25px;
  }
  
  #ten-off-flow p span {
    font-family: 'NBH';
    color: #dc876c;
  }
  
  @media (max-width: 950px) {
    #ten-off-flow p {
      font-size: 16px;
      line-height: 22px;
    }
  }
 
  
  @media (max-width: 737px) {
        
    #ten-off-flow {
      margin-top: 70px;
    }
  }
  
  @media (max-width: 650px) {
    #ten-off-flow p {
      width: 80%;
    }
    #ten-off-flow {
      height: 115px;
    }
  }
  
  @media (max-width: 500px) {
    #ten-off-flow p {
      width: 70%;
    }
  }


  @media (max-width: 405px) {
    #ten-off-flow p {
      width: 85%;
    }
  }
  
  @media (max-width:340px) {
    #ten-off-flow {
      height: 130px;
    }
  }
  
</style>

{% unless customer %}

<div id="ten-off-flow">
  <p>Welcome to Public Goods. Start shopping now and and get $10 off your first order with code <span>healthy19</span>.</p>
</div>

{% endunless %}

<div id="collection_hero" 
     {% if collection.title == 'Gifts' %}class='gift_collection_hero_image'{% endif %}
     {% if collection.title == "What's New" %}class='whats_new_collection_hero_image'{% endif %}
     {% if collection.title == 'Dental Care' %}class='dental_hero_image'{% endif %}
     {% if collection.title == "Travel" %}class='travel_collection_hero_image'{% endif %}
     {% if collection.title == "Essential Oils" %}class='oils_collection_hero_image'{% endif %}
     {% if collection.title == "Oils" %}class='oils_collection_hero_image'{% endif %}
     {% if collection.title == "Tree Free Paper" %}class='tree_free_collection_hero_image'{% endif %}
     {% if collection.title == "Linens" %}class='linens_collection_hero_image'{% endif %}
     {% if collection.title == "Personal Care" %}class='personal_care_collection_hero_image'{% endif %}
     {% if collection.title == "Hair and Body" %}class='personal_care_collection_hero_image'{% endif %}
     {% if collection.title == "Menstrual Care" %}class='menstrual_care_collection_hero_image'{% endif %}
     
     {% if collection.title == "Household" %}class='household_collection_hero_image'{% endif %}
     {% if collection.title == "Bundles" %}class='household_collection_hero_image'{% endif %}
     {% if collection.title == "Laundry" %}class='household_collection_hero_image'{% endif %}
     {% if collection.title == "Kitchen" %}class='household_collection_hero_image'{% endif %}
     {% if collection.title == "Candles" %}class='household_collection_hero_image'{% endif %}
     {% if collection.title == "Zero Waste" %}class='household_collection_hero_image'{% endif %}
     {% if collection.title == "Bathroom" %}class='household_collection_hero_image'{% endif %}
     {% if collection.title == "Cleaners" %}class='household_collection_hero_image'{% endif %}
     
     {% if collection.title == "Pasta and Sauce" %}class='food_hero_image'{% endif %}
     {% if collection.title == "Soups" %}class='soup_hero_image'{% endif %}
     {% if collection.title == "Crackers" %}class='food_hero_image'{% endif %}
     {% if collection.title == "Snacks" %}class='snack_hero_image'{% endif %}
     {% if collection.title == "Condiments" %}class='food_hero_image'{% endif %}
     {% if collection.title == "Beverages" %}class='coffee_collection_hero_image'{% endif %}
     {% if collection.title == "Vegan" %}class='food_hero_image'{% endif %}
     {% if collection.title == "Vegetarian" %}class='food_hero_image'{% endif %}
     {% if collection.title == "Gluten Free" %}class='food_hero_image'{% endif %}
     {% if collection.title == "Food" %}class='food_hero_image'{% endif %}
     {% if collection.title == "Grocery" %}class='food_hero_image'{% endif %}
     {% if collection.title == "Organic" %}class='food_hero_image'{% endif %}
     {% if collection.title == "Cereal and Breakfast" %}class='breakfast_hero_image'{% endif %}
     {% if collection.title == "Oils and Vinegars" %}class='ov_hero_image'{% endif %}
     {% if collection.title == "Canned Goods" %}class='canned_goods_hero_image'{% endif %}
     {% if collection.title == "Spices" %}class='spices_hero_image'{% endif %}
     {% if collection.title == "Chocolate and Sweets" %}class='chocolate_hero_image'{% endif %}
     
     {% if collection.title == "Vitamins and Supplements" %}class='vitamins_collection_hero_image'{% endif %}
     {% if collection.title == "Women's Health" %}class='vitamins_collection_hero_image'{% endif %}
     {% if collection.title == "Men's Health" %}class='vitamins_collection_hero_image'{% endif %}
     {% if collection.title == "Sleep" %}class='vitamins_collection_hero_image'{% endif %}
     {% if collection.title == "Heart" %}class='vitamins_collection_hero_image'{% endif %}
     {% if collection.title == "Hair/Skin/Nails" %}class='vitamins_collection_hero_image'{% endif %}
     {% if collection.title == "Digestion" %}class='vitamins_collection_hero_image'{% endif %}
     {% if collection.title == "Immunity" %}class='vitamins_collection_hero_image'{% endif %}
     {% if collection.title == "Stress" %}class='vitamins_collection_hero_image'{% endif %}
     {% if collection.title == "Fitness" %}class='vitamins_collection_hero_image'{% endif %}
     {% if collection.title == "Protein Powders" %}class='vitamins_collection_hero_image'{% endif %}
     
     {% if collection.title == "Stocking Stuffer" %}class='stocking_collection_hero_image'{% endif %}
     
     {% if collection.title == "Valentine's Day" %}class='valentines_collection_hero_image'{% endif %}
     >
  <div class="row clearfix">
    {% unless collection.title == "All Products" %}<h1 id='all-products-shop-all-title'>{{ collection.title }}</h1>{% endunless %}
    {% if collection.title == "All Products" %}<h1 id='all-products-shop-all-title'>What's New</h1>{% endif %}
  </div>
</div>


<div id="page_content">
  {% unless collection.title == "All Products" %}
  <div class="row">
    <div class="column_12">
      <div class="collections clearfix">
        {% paginate collection.products by 150 %}
        {% for product in collection.products %}

          {%- comment %}<locksmith:6392>{% endcomment -%}
            {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: product, subject_parent: collection, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% else %}{% continue %}{% endif -%}
          {%- comment %}</locksmith:6392>{% endcomment -%}

          {% assign name = 'product' | append:product.id %}
          {% assign idNo = name | append:'-no' %}
          {% assign idYes = name | append:'-yes' %}
		  
          {% assign checkedNo = 'checked' %}
          {% assign checkedYes = '' %}
          {% assign opacityClass = '' %}
          {% assign available = true %}

          {% if product.variants[0].inventory_quantity <= 20 %}
          	{% assign available = false %}
          {% endif %}

          {% if shop.customer_accounts_enabled %}
          	{% if customer %}
        		{% assign checkedNo = 'disabled' %}
        		{% assign checkedYes = 'checked' %}
        		{% assign opacityClass = 'opacity-3' %}

        		{% assign available = true %}
        		{% if product.variants[0].inventory_quantity <= 20 %}
        			{% assign available = false %}
        		{% endif %}
        	{% endif %}
          {% endif %}
        
          <div class="collection">
            <div class="collection_header">
              <a href="{{ product.url | within: collection }}">
                <div class="reveal">
                  <img class="lazyload" data-src="{{ product.featured_image.src | img_url: '600x600' }}" alt="image of {{ product.featured_image.alt | escape }}">
                  <img class="hidden lazyload second-image" data-src="{{ product.images.last | img_url: '600x600' }}" alt="image two of {{ product.images.last.alt | escape }}" />
                </div>
              </a>
              <div class="collection_action" rel="{{name}}">
                 {% if available == true %}
                	{% if customer %}
                	   {% if product.variants.first.sku == "123" or product.variants.first.sku contains "Giftcard" %}
                          <a href="{{ product.url | within: collection }}">
                              <div class="collection_update">
                              </div>
                          </a>
                       {% else %}
                	     <div class="collection_to_cart" rel="{{name}}" onclick="pintrk('track', 'addtocart');">ADD TO CART</div>
                       {% endif %}
                	{% else %}
                	  <div class="collection_to_cart subscribe-to-membership subscribe-to-membership-32-45" rel="{{name}}">ADD TO CART</div>
                	{% endif %}
                	<div class="collection_update">
                      <div class="collection_update_spans clearfix">
                        <span class="collection_minus" rel="{{name}}"></span>
                        <div>
                          <span class="collection_count" id="collection_count_{{product.id}}"></span> IN CART
                        </div>
                        <span class="collection_plus" rel="{{name}}"></span>
                      </div>
                    </div>
                {% else %}
                	<div class="collection_coming_soon" rel="{{name}}">SOLD OUT - NOTIFY ME</div>
                {% endif %}
              </div> <!-- Collection Action End !-->
            </div>
            <div class="collection_body">
              
              <label class="collection_title all-products-product-stars"><a href="{{ product.url | within: collection }}">{{ product.title }}</a> 
                <a href="{{ product.url | within: collection | append: '#anchor-reviews'}}">  <!--- Star Reviews !--->
                  <div class="yotpo bottomLine yotpo-small"
                    data-appkey="1czk4hDZQU9jrmp3MaNi1wqhc05RABHrg6aDSVLd"
                    data-domain="{{shop.permanent_domain | escape }}"
                    data-product-id="{{ product.id }}"
                    data-product-models="{{ product.id }}"
                    data-name="{{ product.title | escape }}"
                    data-url="{{ shop.url }}{{ product.url }}"
                    data-image-url="{{ product.featured_image | product_img_url: 'large' |replace: '?', '%3F' | replace: '&','%26'}}"
                    data-description="{{ product.description | escape }}"
                    data-bread-crumbs="{% for tag in product.tags %}{{ tag | escape }};{% endfor %}">
                  </div>
                </a>
              </label>
              
               {% if customer and product.variants.first.sku != "Giftcard10" %}
              	<div class="var_checkbox"><input type="hidden" name="{{name}}" id="{{idYes}}" value="{{ product.variants[0].id }}" class="productYes" {{checkedYes}}/><label style="cursor:default;" for="{{idYes}}" onclick="">{{ product.variants[0].price | money }} <font>{{ product.variants[0].title | remove: '(member)'}}<small>{% unless customer %}<!-- With membership, from $59 / year -->{% endunless %}</small></font></label></div>
              {% else %}
              	{% if product.variants.first.sku != "Giftcard10" %}
				  <a class="subscribe-to-membership-32-45 subscribe-to-membership membuttonclick free"><div><input type="hidden" name="{{name}}" id="{{idYes}}" value="{{ product.variants[0].id }}" class="productYes" {{checkedYes}}/><label style="color:#000; " for="{{idYes}}" onclick="">{{ product.variants[0].price | money }} <font>{{ product.variants[0].title }} <small>{% unless customer %}<!-- With membership of $59 / year -->{% endunless %}</small></font></label></div></a>
                {% endif %}
              {% endif %}

            </div>
          </div>
  

        {% endfor %}
        
        {% if paginate.pages > 1 %}
<!--         <div class="pagination">
          {{ paginate | default_pagination | replace: '&laquo; Previous', '&larr;' | replace: 'Next &raquo;', '&rarr;' }}
        </div> -->
      {% endif %}
 {% endpaginate %}
      </div> <!-- Collections End !-->
    </div>
    
      <div id='filter-separator'>
        <h1>All Products</h1>
      </div>
  </div><!-- Row End !-->
  
 {% endunless %}
  
 {% if collection.title == "All Products" %}
  
  <div class="row">
    <div class="column_12">
      <div class="collections clearfix">
        {% paginate collection.products by 18 %}
        {% for product in collections.whats-new-to-public-goods.products %}

          {%- comment %}<locksmith:64de>{% endcomment -%}
            {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: product, subject_parent: collections.whats-new-to-public-goods, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% else %}{% continue %}{% endif -%}
          {%- comment %}</locksmith:64de>{% endcomment -%}

          {% assign name = 'product' | append:product.id %}
          {% assign idNo = name | append:'-no' %}
          {% assign idYes = name | append:'-yes' %}
		  
          {% assign checkedNo = 'checked' %}
          {% assign checkedYes = '' %}
          {% assign opacityClass = '' %}
          {% assign available = true %}

          {% if product.variants[0].inventory_quantity <= 20 %}
          	{% assign available = false %}
          {% endif %}

          {% if shop.customer_accounts_enabled %}
          	{% if customer %}
        		{% assign checkedNo = 'disabled' %}
        		{% assign checkedYes = 'checked' %}
        		{% assign opacityClass = 'opacity-3' %}

        		{% assign available = true %}
        		{% if product.variants[0].inventory_quantity <= 20 %}
        			{% assign available = false %}
        		{% endif %}
        	{% endif %}
          {% endif %}
        
          <div class="collection">
            <div class="collection_header">
              <a href="{{ product.url | within: collection }}">
                <div class="reveal">
                  <img class="lazyload" data-src="{{ product.featured_image.src | img_url: '600x600' }}" alt="image of {{ product.featured_image.alt | escape }}">
                  <img class="hidden lazyload second-image" data-src="{{ product.images.last | img_url: '600x600' }}" alt="image two of {{ product.images.last.alt | escape }}" />
                </div>
              </a>
              <div class="collection_action" rel="{{name}}">
                 {% if available == true %}
                	{% if customer %}
                	   {% if product.variants.first.sku == "123" or product.variants.first.sku contains "Giftcard" %}
                          <a href="{{ product.url | within: collection }}">
                              <div class="collection_update">
                              </div>
                          </a>
                       {% else %}
                	     <div class="collection_to_cart" rel="{{name}}" onclick="pintrk('track', 'addtocart');">ADD TO CART</div>
                       {% endif %}
                	{% else %}
                	  <div class="collection_to_cart subscribe-to-membership subscribe-to-membership-32-45" rel="{{name}}">ADD TO CART</div>
                	{% endif %}
                	<div class="collection_update">
                      <div class="collection_update_spans clearfix">
                        <span class="collection_minus" rel="{{name}}"></span>
                        <div>
                          <span class="collection_count" id="collection_count_{{product.id}}"></span> IN CART
                        </div>
                        <span class="collection_plus" rel="{{name}}"></span>
                      </div>
                    </div>
                {% else %}
                	<div class="collection_coming_soon" rel="{{name}}">SOLD OUT - NOTIFY ME</div>
                {% endif %}
              </div> <!-- Collection Action End !-->
            </div>
            <div class="collection_body">
              
              <label class="collection_title all-products-product-stars"><a href="{{ product.url | within: collection }}">{{ product.title }}</a> 
                <a href="{{ product.url | within: collection | append: '#anchor-reviews'}}">  <!--- Star Reviews !--->
                  <div class="yotpo bottomLine yotpo-small"
                    data-appkey="1czk4hDZQU9jrmp3MaNi1wqhc05RABHrg6aDSVLd"
                    data-domain="{{shop.permanent_domain | escape }}"
                    data-product-id="{{ product.id }}"
                    data-product-models="{{ product.id }}"
                    data-name="{{ product.title | escape }}"
                    data-url="{{ shop.url }}{{ product.url }}"
                    data-image-url="{{ product.featured_image | product_img_url: 'large' |replace: '?', '%3F' | replace: '&','%26'}}"
                    data-description="{{ product.description | escape }}"
                    data-bread-crumbs="{% for tag in product.tags %}{{ tag | escape }};{% endfor %}">
                  </div>
                </a>
                
                
                
              </label>
              
               {% if customer and product.variants.first.sku != "Giftcard10" %}
              	<div class="var_checkbox"><input type="hidden" name="{{name}}" id="{{idYes}}" value="{{ product.variants[0].id }}" class="productYes" {{checkedYes}}/><label style="cursor:default;" for="{{idYes}}" onclick="">{{ product.variants[0].price | money }} <font>{{ product.variants[0].title | remove: '(member)'}}<small>{% unless customer %} <!-- With membership, from $59 / year  -->{% endunless %}</small></font></label></div>
              {% else %}
              	{% if product.variants.first.sku != "Giftcard10" %}
				  <a class="subscribe-to-membership-32-45 subscribe-to-membership membuttonclick free"><div><input type="hidden" name="{{name}}" id="{{idYes}}" value="{{ product.variants[0].id }}" class="productYes" {{checkedYes}}/><label style="color:#000; " for="{{idYes}}" onclick="">{{ product.variants[0].price | money }} <font>{{ product.variants[0].title }} <small>{% unless customer %}<!-- With membership of $59 / year  -->{% endunless %}</small></font></label></div></a>
                {% endif %}
              {% endif %}

            </div>
          </div>
        {% endfor %}
        
        {% if paginate.pages > 1 %}
<!--         <div class="pagination">
          {{ paginate | default_pagination | replace: '&laquo; Previous', '&larr;' | replace: 'Next &raquo;', '&rarr;' }}
        </div> -->
      {% endif %}
 {% endpaginate %}
      </div> <!-- Collections End !-->
    </div>
    
      <div id='filter-separator'>
        <h1>All Products</h1>
      </div>
  </div><!-- Row End !-->
 
 {% endif %}
  
  
  <div class="row">
  <div class="column_12">
     {% paginate collections.all-products.products by 18 %}
      <div class="collections clearfix AjaxinateLoop">
        {% for product in collections.all-products.products %}
        
          {%- comment %}<locksmith:ce1a>{% endcomment -%}
            {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: product, subject_parent: collections.all-products, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% else %}{% continue %}{% endif -%}
          {%- comment %}</locksmith:ce1a>{% endcomment -%}
        
          {% if collection.title == "Bathroom" %}
            {% assign collectionTag = "bathroom" %}
          {% endif %}
        
          {% if collection.title == "Bundles" %}
              {% assign collectionTag = "bundle" %}
            {% endif %}

          {% if collection.title == "Candles" %}
              {% assign collectionTag = "candles" %}
            {% endif %}
        
         {% if collection.title == "Canned Goods" %}
              {% assign collectionTag = "canned-food" %}
            {% endif %}

          {% if collection.title == "Cereal and Breakfast" %}
              {% assign collectionTag = "cereal-breakfast" %}
            {% endif %}

          {% if collection.title == "Cleaners" %}
              {% assign collectionTag = "cleaners" %}
            {% endif %}

          {% if collection.title == "Coffee and Tea" %}
              {% assign collectionTag = "coffee-tea" %}
            {% endif %}
        
          {% if collection.title == "Beverages" %}
            {% assign collectionTag = "beverages" %}
          {% endif %}

          {% if collection.title == "Condiments" %}
              {% assign collectionTag = "condiments" %}
            {% endif %}

          {% if collection.title == "Crackers" %}
              {% assign collectionTag = "crackers" %}
            {% endif %}

          {% if collection.title == "Dental Care" %}
              {% assign collectionTag = "dental" %}
            {% endif %}

          {% if collection.title == "Essential Oils" %}
              {% assign collectionTag = "oil" %}
            {% endif %}

          {% if product.type == 'Gifts' %}
              {% assign collectionTag = "gifts" %}
            {% endif %}

          {% if collection.title == "Hair and Body" %}
              {% assign collectionTag = "hair-body" %}
	          {% assign collectionTag2 = true %}
            {% endif %}

          {% if collection.title == "Household" %}
              {% assign collectionTag = "household" %}
            {% endif %}

          {% if collection.title == "Kitchen" %}
              {% assign collectionTag = "kitchen" %}
            {% endif %}

          {% if collection.title == "Laundry" %}
              {% assign collectionTag = "laundry" %}
            {% endif %}

          {% if collection.title == "Linens" %}
              {% assign collectionTag = "linen" %}
            {% endif %}

          {% if collection.title == "Oils and Vinegars" %}
              {% assign collectionTag = "oils-vinegars" %}
            {% endif %}

          {% if collection.title == "Pasta and Sauce" %}
              {% assign collectionTag = "grains-pasta" %}
            {% endif %}

          {% if collection.title == "Personal Care" %}
              {% assign collectionTag = "personal care" %}
            {% endif %}

          {% if collection.title == "Protein Powders" %}
              {% assign collectionTag = "protein-powders" %}
            {% endif %}

          {% if collection.title == "Snacks" %}
              {% assign collectionTag = "snacks" %}
            {% endif %}
        
        {% if collection.title == "Soups" %}
        	{% assign collectionTag = "soups" %}
        {% endif %}
        
        {% if collection.title == "Travel" %}
        	{% assign collectionTag = "travel" %}
        {% endif %}
        
        {% if collection.title == "Tree Free Paper" %}
        	{% assign collectionTag = "treefree" %}
        {% endif %}
        
        {% if collection.title == "Zero Waste" %}
        	{% assign collectionTag = "zero-waste" %}
        {% endif %}
        
        {% if collection.title == "Grocery" %}
          {% assign collectionTag = "grocery" %}
        {% endif %}
        
        {% if collection.title == "Vitamins and Supplements" %}
          {% assign collectionTag = "vitamin-supplements" %}
        {% endif %}
        
        {% if collection.title == "Menstrual Care" %}
          {% assign collectionTag = "menstrual-care" %}
        {% endif %}
        
        {% if collection.title == "Spices" %}
          {% assign collectionTag = "Spices" %}
        {% endif %}
        
          {% unless product.tags contains collectionTag %} 
			        
            {% assign name = 'product' | append:product.id %}
            {% assign idNo = name | append:'-no' %}
            {% assign idYes = name | append:'-yes' %}

            {% assign checkedNo = 'checked' %}
            {% assign checkedYes = '' %}
            {% assign opacityClass = '' %}
            {% assign available = true %}

            {% if product.variants[0].inventory_quantity <= 20 %}
              {% assign available = false %}
            {% endif %}

            {% if shop.customer_accounts_enabled %}
              {% if customer %}
                  {% assign checkedNo = 'disabled' %}
                  {% assign checkedYes = 'checked' %}
                  {% assign opacityClass = 'opacity-3' %}

                  {% assign available = true %}
                  {% if product.variants[0].inventory_quantity <= 20 %}
                      {% assign available = false %}
                  {% endif %}
              {% endif %}
            {% endif %}

           <div class="collection">
            <div class="collection_header">
              <a href="{{ product.url | within: collection }}">
                <div class="reveal">
                  <img class="lazyload" data-src="{{ product.featured_image.src | img_url: '600x600' }}" alt="{{ product.featured_image.alt | escape }}">
                  <img class="hidden lazyload second-image" data-src="{{ product.images.last | img_url: '600x600' }}" alt="{{ product.images.last.alt | escape }}" />
                </div>
              </a>
             <div class="collection_action" rel="{{name}}">
                {% if available == true %}
                	{% if customer %}
                	   {% if product.variants.first.sku contains "Giftcard" or product.variants.first.sku == "123" %}
                          <a href="{{ product.url | within: collection }}">
                              <div class="collection_update">
                              </div>
                          </a>
                       {% else %}
                	     <div class="collection_to_cart" rel="{{name}}" onclick="pintrk('track', 'addtocart');">ADD TO CART</div>
                       {% endif %}
                	{% else %}
                	  <div class="collection_to_cart subscribe-to-membership subscribe-to-membership-32-45" value="{{ product.variants[0].id }}" rel="{{name}}">ADD TO CART</div>
                	{% endif %}
                	<div class="collection_update">
                      <div class="collection_update_spans clearfix">
                        <span class="collection_minus custom_collection_minus" rel="{{name}}"></span>
                        <div>
                          <span class="collection_count" id="collection_count_{{product.id}}"></span> IN CART
                        </div>
                        <span class="collection_plus custom_collection_plus" rel="{{name}}"></span>
                      </div>
                    </div>
                {% else %}
                <div class="collection_coming_soon" rel="{{name}}">SOLD OUT - NOTIFY ME</div>
                {% endif %}
              </div> <!-- Collection Action End !-->
            </div>
            <div class="collection_body">
              
              <label class="collection_title all-products-product-stars">
                <a href="{{ product.url | within: collection }}">{{ product.title }}</a> 
                <a href="{{ product.url | within: collection | append: '#anchor-reviews'}}"> 
                  <!--- Star Reviews !--->
                  <div id="wrapper-yot" class="yotpo bottomLine yotpo-small"
                    data-appkey="1czk4hDZQU9jrmp3MaNi1wqhc05RABHrg6aDSVLd"
                    data-domain="{{shop.permanent_domain | escape }}"
                    data-product-id="{{ product.id }}"
                    data-product-models="{{ product.id }}"
                    data-name="{{ product.title | escape }}"
                    data-url="{{ shop.url }}{{ product.url }}"
                    data-image-url="{{ product.featured_image | product_img_url: 'large' |replace: '?', '%3F' | replace: '&','%26'}}"
                    data-description="{{ product.description | escape }}"
                    data-bread-crumbs="{% for tag in product.tags %}{{ tag | escape }};{% endfor %}">
                  </div>
                </a>                
              </label>             
              
             <!-- <div><input type="hidden" rel="{{product.variants[0].inventory_quantity}}" name="{{name}}" id="{{idNo}}" value="{{ product.variants[0].id }}" class="productNo" {{checkedNo}}/><label for="{{idNo}}" onclick="">{{ product.variants[0].price | money }}</label></div>
-->
              {% if customer and product.variants.first.sku != "Giftcard10" %}
              	<div class="var_checkbox"><input type="hidden" name="{{name}}" class="cYes" id="{{idYes}}" value="{{ product.variants[0].id }}" class="productYes" {{checkedYes}}/><label style="cursor:default;" for="{{idYes}}" onclick="">{{ product.variants[0].price | money }} <font>{{ product.variants[0].title | remove: '(member)'}}<small>{% unless customer %}<!-- With membership, from $59 / year -->{% endunless %}</small></font></label></div>
              {% else %}
              	{% if product.variants.first.sku != "Giftcard10" %}
				  <a class="subscribe-to-membership-32-45 subscribe-to-membership membuttonclick free"><div><input type="hidden" name="{{name}}" id="{{idYes}}" value="{{ product.variants[0].id }}" class="productYes" {{checkedYes}}/><label style="color:#000; " for="{{idYes}}" onclick="">{{ product.variants[0].price | money }} <font>{{ product.variants[0].title }} <small>{% unless customer %}<!-- With membership of $59 / year -->{% endunless %}</small></font></label></div></a>
                {% endif %}
              {% endif %}              
            </div>
          </div>        
          {% endunless %}
        {% endfor %}
         <!-- Collections End !-->
    </div>
    
    <div id="loadmoretop" class="AjaxinatePagination" style="display: none;">
      {% if paginate.next %}
        <a id="loadbuttonMore" class="home-shop-btn" href="{{ paginate.next.url }}">
          <img id="loadbuttonMores" src="https://media.giphy.com/media/3oEjI6SIIHBdRxXI40/giphy.gif"></a>
      {% endif %}
       
    </div>
    
     <div class="dumbspinner">
      {% if paginate.next %}
        <a class="home-shop-btn" href="javascript:;"><img src="https://media.giphy.com/media/3oEjI6SIIHBdRxXI40/giphy.gif"></a>
      {% endif %}
       
     </div>
    
    {% endpaginate %}
  </div>  
    
  </div><!-- Row End !-->
    <div class="shop-by-category">
      <div class="main-categories">
          <div class="main-categories-tile main-categories-pc">
            <a class="no-decor" href="https://www.publicgoods.com/collections/personal-care">
              <div class="main-categories-words">
                <h2>Personal Care</h2>
                <a href="https://www.publicgoods.com/collections/personal-care">shop all</a>
              </div>
            </a>
          </div>
          <div class="main-categories-tile main-categories-household">
            <a class="no-decor" href="https://www.publicgoods.com/collections/household">
              <div class="main-categories-words">
                <h2>Home Essentials</h2>
                <a href="https://www.publicgoods.com/collections/household">shop all</a>
              </div>
            </a>
          </div>
          <div class="main-categories-tile main-categories-food">
            <a class="no-decor" href="https://www.publicgoods.com/collections/grocery">
              <div class="main-categories-words">
                <h2>Healthy Food</h2>
                <a href="https://www.publicgoods.com/collections/grocery">shop all</a>
              </div>
            </a>
          </div>
           <div class="main-categories-tile main-categories-vitamins">
             <a class="no-decor" href="https://www.publicgoods.com/collections/vitamins-and-supplements">
              <div class="main-categories-words">
                <h2>Vitamins and Supplements</h2>
                <a href="https://www.publicgoods.com/collections/vitamins-and-supplements">shop all</a>
              </div>
             </a>
          </div>
      </div>
  </div>

</div> <!-- Page Content End !-->


{% include 'get-Notified-Popup' %}
{% include 'smooth-scroll-all-prod' %}
{% include 'reactivate-popup' %}
{% include 'annual-payment-failed-popup' %}

<script type="text/javascript" language="javascript" defer>
  var member = 0;
  var idNo_modal = '';
  var idYes_modal = '';
  
  function get_cart_items(){
    $('.collection_to_cart').show();
    $('.collection_update').hide();
    $('.collection_update').css('opacity', 0);

    $.ajax({
      type:'GET', 
      url:'/cart.js', 
      dataType: 'json',
      success: function(data){
        var items = data.items;

        cart_items = items;

        for(var i in items){
          var temp = [];

          if(items[i].merged)
            continue;

          temp.product_id = items[i].product_id;
          temp.quantity = parseInt(items[i].quantity);
          items[i].merged = true;

          for(var j in items){
            if(i >= j || items[j].merged)
              continue;

            if(items[i].product_id == items[j].product_id){
              temp.quantity += parseInt(items[j].quantity);
              items[j].merged = true;
            }
          }

          var id = 'collection_count_' + temp.product_id;
          $('#'+id).html(temp.quantity);

          var object = $('#'+id).parents('.collection_action:first');
          object.find('.collection_to_cart:first').hide();
          object.find('.collection_update:first').show();
          object.find('.collection_update:first').css('opacity', 1);
        }
      }
    });
  }
  
  function find_cart_quantity(id, action){
    var quantity = 0;
    if(cart_items.length > 0){
      for(var i in cart_items){
        if(cart_items[i].id == id){
          if(action == 'minus')
            cart_items[i].quantity -= 1;
          else if(action == 'plus')
            cart_items[i].quantity += 1;      

          quantity = cart_items[i].quantity;

          break;
        }
      }
    }

    return parseInt(quantity);
  }

  function update_cart_count(action){
    var quantity = parseInt($('#CartCount').html());

    if(action == 'minus')
      quantity--;
    else if(action == 'plus')
      quantity++;

    $('#CartCount').html(quantity);
    $('#CartCount_mobile').html(quantity);
  }
  
  document.addEventListener("DOMContentLoaded", function() {
    console.log('DOM Content Loaded');

    var endlessClick = new Ajaxinate({
      method: 'click',
      callback: function(){
        get_cart_items();
                  blogSlider();
      }
    });
  });
  
  {% if shop.customer_accounts_enabled %}
    {% if customer %}
      member = 1;
    {% endif %}
  {% endif %}
  
  
  	
  $(document).ready(function(){

    {% for tag in customer.tags %} 
    {% if tag == 'member' or tag == 'members' or tag == 'Member' %}
    {% assign nonmember = false %}
    {% endif %}
    {% if tag == 'Unsubscribed' or tag == 'unsubscribed' or tag == 'membershipPaymentFailed' %}
    {% assign nonmember = true %}
    {% endif %}
    {% if tag == 'membershipPaymentFailed' %}
    {% assign failedAnnualPayment = true %}
    {% endif %}
    {% endfor %}

    {% if customer.tags contains 'lifetime' or customer.tags contains 'Lifetime' %}
    {% assign nonmember = false %}
    {% endif %}

    // ten off promo
    if (sessionStorage.getItem("pg10Off")) {
      $("#ten-off-flow").css("display", "block")
    }

    // Update cart count for incase of cache issue
    (function() {

      jQuery.getJSON('/cart.js', function(cart) {

        $('#CartCount').html(cart.item_count);
      });

    })()


    var modal = $('#customModal');
    var modalDom = document.getElementById('customModal');

    var cart_items = {};

    $(document).on('click', '.productYes', function(){
      if(member == 0){
        $("a#membership_button_11118").click();

        // modal.show();
        // $('body').css('overflow', 'hidden');

        var name = $(this).parents('.collection:first').find('.collection_action:first').attr('rel');

        idNo_modal = name + '-no';
        idYes_modal = name + '-yes';

        $('#'+idYes_modal).removeAttr('checked');
        $('#'+idNo_modal).prop('checked',true);
      }
    });

    $(document).on('click', '.collection_minus', function(e){
      e.preventDefault();
      e.stopPropagation();
      var object = $(this).parents('.collection_update_spans:first');
      var quantity_object = object.find('.collection_count:first');
      var total_quantity = parseInt(quantity_object.html());
      var name = $(this).attr('rel');

      var idNo = name + '-no';
      var idYes = name + '-yes';

      //       var variantId = $('#'+idNo).val();
      //       if($('#'+idYes).prop('checked'))
      //         variantId = $('#'+idYes).val();
      var variantId = $('#'+idYes).val();

      var quantity = find_cart_quantity(variantId, 'minus');

      $.ajax({
        type:'POST', 
        url:'/cart/change.js', 
        data: {id: variantId, quantity: quantity}, 
        dataType: 'json',
        success: function(data){
          setCartItem(variantId, {id: $('#'+idYes).val(), quantity: quantity});
          if(total_quantity > 1)
            quantity_object.html(total_quantity-1);
          else
            get_cart_items();

          update_cart_count('minus');


        }
      });  
    });

    $(document).on('click', '.collection_plus', function(e){
      e.preventDefault();
      e.stopPropagation();
      var object = $(this).parents('.collection_update_spans:first');
      var quantity_object = object.find('.collection_count:first');
      var total_quantity = parseInt(quantity_object.html());
      var name = $(this).attr('rel');

      var idNo = name + '-no';
      var idYes = name + '-yes';

      //       var variantId = $('#'+idNo).val();
      //       if($('#'+idYes).prop('checked'))
      //         variantId = $('#'+idYes).val();
      var variantId = $('#'+idYes).val();

      var quantity = find_cart_quantity(variantId, 'plus');

      $.ajax({
        type:'POST', 
        url:'/cart/change.js', 
        data: {id: variantId, quantity: quantity}, 
        dataType: 'json',
        success: function(data){
          get_cart_items();
          setCartItem(variantId, {id: $('#'+idYes).val(), quantity: quantity});
          quantity_object.html(total_quantity+1);
          update_cart_count('plus');

          //             jQuery.getJSON('/cart.js', function(cart) {
          //               console.log('in')
          //               $('#CartCount').html(cart.item_count);
          //             });
        }
      });  
    });

    $(document).on('click', '.collection_to_cart', function(e){
      e.preventDefault();
      e.stopPropagation();
      
      fbq('track', 'AddToCart');

      var name = $(this).attr('rel');

      var object = $(this).parents('.collection_action:first');

      var idNo = name + '-no';
      var idYes = name + '-yes';

      //       var variantId = $('#'+idNo).val();
      //       if($('#'+idYes).prop('checked'))
      //         variantId = $('#'+idYes).val();
      var variantId = $('#'+idYes).val();

      {% if nonmember == true %}
        {% if failedAnnualPayment == true %}
          $('#payment-failed-pop-up-wrapper').css('display', 'block')
          let popupWidth = (window.innerWidth - $('#payment-failed-pop-up-wrapper').width()) / 2
          $('#payment-failed-pop-up-wrapper').css('right', popupWidth )
        {% else %}
          $('#reactivate-pop-up-wrapper').css('display', 'block')
          let popupWidth = (window.innerWidth - $('#reactivate-pop-up-wrapper').width()) / 2
          $('#reactivate-pop-up-wrapper').css('right', popupWidth )
        {% endif %}
      {% endif %}

      {% unless nonmember == true %}
      $.ajax({
        type:'POST', 
        url:'/cart/add', 
        data: {id: variantId, quantity: 1},
        dataType: 'json',
        success: function(data){
          get_cart_items();
          update_cart_count('plus');
          setCartItem(variantId, {id: $('#'+idYes).val(), quantity: 1});
        }
      });
      {% endunless %}
    });

    // For Out Of Stock Notifications

    var referenceToThis = "ayy";
    var name;
    var object;
    var productName;


    $(document).on('click', '.collection_coming_soon', function(e) {
      e.preventDefault();
      e.stopPropagation();

      referenceToThis = this

      $("#notify-pop-up-wrapper").css("display", "block")

      productName = e.target.parentElement.parentElement.parentElement.children[1].children[0].children[0].innerText

      document.getElementById("oos-product-name").innerText = productName

      name = $(this).attr('rel');

      object = $(this).parents('.collection_action:first');

    })

    $(document).on('click', '#submit-btn', function(e) {
      e.preventDefault();
      e.stopPropagation();

      var idNo = name + '-no';
      var idYes = name + '-yes';

      var variantId = $('#'+idYes).val();

      var notifyEmail = $("#notify-email").val()

      var productId = name.substring(7)


      if($('#'+idYes).prop('checked'))
        variantId = $('#'+idYes).val();

      BIS.create(notifyEmail, variantId, productId).then(function(resp) { 
        if (resp.status == 'OK') {
          $("#err-success-msg").text("Thanks! We'll email you as soon as it's available.").css("color", "#dc886c")
        } else if (resp.errors.email) {
          $("#err-success-msg").text(resp.errors.email[0]).css("color", "red")
        } else {
          $("#err-success-msg").text("There seems to be a problem with our notification system. Please contact customer service.").css("color", "red")
        }
      });
    })

    $('#boldTrigger').click(function(){
      $('.modal-close').click();
      $('#checkout_11118 a').click();
    });

    $('.modal-close').click(function(){
      modal.hide();
      $('body').css('overflow', 'auto');

      if(idYes_modal != '' && idNo_modal != ''){
        $('#'+idYes_modal).removeAttr('checked');
        $('#'+idNo_modal).prop('checked',true);

        idYes_modal = '';
        idNo_modal = '';
      }
    });

    $(window).click(function(e){
      if (e.target == modalDom){
        modal.hide();
        $('body').css('overflow', 'auto');

        if(idYes_modal != '' && idNo_modal != ''){
          $('#'+idYes_modal).removeAttr('checked');
          $('#'+idNo_modal).prop('checked',true);

          idYes_modal = '';
          idNo_modal = '';
        }
      }
    });

    $('body').on('afterChangeItem.ajaxCart', function(evt, cart) {
      console.log('afterChangeItem');
      get_cart_items();
    });

    $('body').on('afterAddItem.ajaxCart', function(evt, cart) {
      console.log('afterAddItem');
      get_cart_items();
    });

    $(window).load(function(){
      var match = new RegExp('[?&]cart=([^&]*)').exec(window.location.href);

      var param = match && decodeURIComponent(match[1].replace());

      if(param == 'show'){
        ajaxCart.load();
        timber.RightDrawer.open()
      }
    });
  });
  
  
function blogSlider() {

  yotpo.initWidgets();
 
}

  
//     $(window).scroll(function () {
//       //set scroll position in session storage
//       sessionStorage.scrollPos = $(window).scrollTop();
//     });
//     var init = function () {
//        //return scroll position in session storage
//        $(window).scrollTop(sessionStorage.scrollPos || 0)
//     };
//     window.onload = init;
  
  var scrolling = false;
 
  $( window ).scroll( function() {
    scrolling = true;
  });

  setInterval( function() {
    if ( scrolling ) {
      scrolling = false;
      if ($(".drawer").is(':hidden')) {
        document.getElementById("loadbuttonMore").click();
      }

      if (((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 20) && $(".drawer").is(':hidden')) {
        $(".dumbspinner").hide();
        document.getElementById("loadbuttonMore").click();
      }
    }
  }, 250 );

  
  
//   window.onscroll = function(){

//     //var targetTop = document.getElementById('loadmoretop').offsetTop;

// 	//targetTop = targetTop - 600;
//     //console.log(targetTop);
//     //console.log(window.pageYOffset);
//    // if( window.pageYOffset >= 100 ){

//     if ($(".drawer").is(':hidden')) {
//       document.getElementById("loadbuttonMore").click();
//     }
    
//     if (((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 20) && $(".drawer").is(':hidden')) {
//       $(".dumbspinner").hide();
//       document.getElementById("loadbuttonMore").click();
//     }
    
// //      if($(window).scrollTop() + $(window).height() > $(document).height() - 20) {
// //          $(".dumbspinner").hide();
// //          document.getElementById("loadbuttonMore").click();
// //      }


//   };
  
  
  window.ontouchmove = function(){

    //var targetTop = document.getElementById('loadmoretop').offsetTop;

    //targetTop = targetTop - 1800;
    // console.log(targetTop);
    // console.log(window.pageYOffset);
    //if( document.body.scrollTop >= 100 ){


    if ($(".drawer").is(':hidden')) {
      document.getElementById("loadbuttonMore").click();
    }

    if (((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 20) && $(".drawer").is(':hidden')) {
      $(".dumbspinner").hide();
      document.getElementById("loadbuttonMore").click();
    }

    //}


  };
</script>

  {% include 'Howd-ya-hear-about-us' %}

<style>
  .dumbspinner a.home-shop-btn {
    cursor: unset !important;
}
  .shop-by-category {
    text-align: center;
    width: 90%;
    margin: 0 auto;
  }
  
  .main-categories {
    display: flex;
    height: 230px;
    justify-content: space-between;
    margin-bottom: 50px;
  }

  .main-categories-tile {
    width: 24%;
    background-size: cover;
    background-position-y: 100%;
    cursor: default;
  }

  .main-categories-pc {
    background-image: url("https://cdn.shopify.com/s/files/1/0838/7991/files/tile_personal_care.jpg?12413255820896601983")
  }

  .main-categories-household {
    background-image: url("https://cdn.shopify.com/s/files/1/0838/7991/files/tile_household.jpg?12413255820896601983")
  }

  .main-categories-food {
    background-image: url("https://cdn.shopify.com/s/files/1/0838/7991/files/tile_food.jpg?12413255820896601983")  
  }

  .main-categories-vitamins {
    background-image: url(https://cdn.shopify.com/s/files/1/0838/7991/files/tile_vitamins_retouch.jpg?41730);
    background-position-x: 85%;
  }

  .main-categories-words {
    margin-top: 120px;
  }

  .main-categories-words a {
    color: #000;
    text-decoration: underline;
    margin-top: 5px;
  }

  .main-categories-words h2 {
    margin-bottom: 5px;
    line-height: 24px;
  }
  
  .no-decor {
        text-decoration: none !important;
  }
  
  @media (max-width: 1300px) {
    .main-categories-household {
      background-position-x: 35%;
    }
    .main-categories-food {
      background-position-x: 75%;
    }
  }
  
  @media (max-width: 1000px) {
    .main-categories {
      display: block;
      height: auto;
      text-align: -webkit-center;
      text-align: -moz-center;
    }

    .main-categories-household {
      margin: 50px 0;
    }

    .main-categories-vitamins {
      margin-top: 50px;
    }

    .main-categories-tile {
      width: 75%;
      height: 300px;
    }

    .main-categories-words {
      margin-top: 0;
      padding-top: 140px;
    }
  
  }
  
  @media (max-width: 600px) {
   .main-categories-tile {
      width: 100%;
    }
  }
  
  @media (max-width: 460px) {
    .main-categories-tile {
      background-position: bottom;
    }
  }
  
  .dumbspinner, .dumbspinner > a {
    text-align: center;
    padding: 0 !important;
    margin: 0;
  }
  
</style>
